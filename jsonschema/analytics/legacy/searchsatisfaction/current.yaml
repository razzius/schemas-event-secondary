title: analytics/legacy/searchsatisfaction
description: >
  Tracks the dwell time and bounce rate of a user on pages linked from
  a search engine result page.
  Legacy metawiki schema: https://meta.wikimedia.org/wiki/Schema:SearchSatisfaction
$id: /analytics/legacy/searchsatisfaction/1.0.0
$schema: https://json-schema.org/draft-07/schema#
type: object
allOf:
  - $ref: /fragment/analytics/legacy/eventcapsule/1.0.0#
  # event data fields.
  - required:
      - event
    properties:
      event:
        type: object
        additionalProperties: false
        required:
          - action
          - searchsessionid
          - pageviewid
          - scroll
          - mwsessionid
          - source
          - uniqueid
        properties:
          action:
            type: string
            enum:
            - searchResultPage
            - visitPage
            - checkin
            - click
            - iwclick
            - ssclick
            - esclick
            - hover-on
            - hover-off
            description: Identifies the context in which the event was created. Every time
              a new search is performed a searchEngineResultPage event is created. When the
              user clicks a link in the results a visitPage event is created. When the user
              has dwelled for N seconds (see 'checkin' below) a checkin event occurs. If the
              user clicks an interwiki result provided by TextCat language detection, there
              is a click event. If the user clicks on a sister search result from the sidebar,
              that's an ssclick. If the user interacts with a result to explore similar (pages,
              categories, translations), there are hover-on, hover-off, and esclick events.
          searchsessionid:
            type: string
            description: A unique identifier generated per search session. A search session
              identifies a single user performing searches within a limited timespan. If no
              search is performed within ten minutes of a previous search a new session id
              is generated.
          pageviewid:
            type: string
            description: A unique identifier generated per visited page. This allows a visitPage
              and checkin events to be directly correlated.
          scroll:
            type: boolean
            description: Indicates if the user has scrolled the page since the last event
              with the same pageId
          checkin:
            type: integer
            description: A numeric value representing the number of seconds a user has spent
              on a page. As with Schema:TestSearchSatisfaction2, the pings are at 10s, 20s,
              ..., 50s, 60s, 90s, 120s (2min), 150s, 180s (3min), 210s, 240s (4min), 300s
              (5min), 360s (6min), 420s (7min).
          query:
            type: string
            description: The actual terms the user searched for. This is only logged with
              searchResultPage actions
          hitsreturned:
            type: integer
            description: The number of results returned and shown in the SERP. This is only
              logged with searchResultPage actions
          articleid:
            type: integer
            description: The mediawiki article id of the current page, if the current page
              is an article.
          position:
            type: integer
            description: The position of the search result in the search result set, including
              any offsets.
          subtest:
            type: string
            description: The name of any sub-test that this user is participating in.
          mwsessionid:
            type: string
            description: MediaWiki session id for correlating together actions in other schemas,
              such as QuickSurveys.
          source:
            type: string
            enum:
            - autocomplete
            - fulltext
            description: The type of search that triggered the event. Either autocomplete
              or fulltext.
          inputlocation:
            type: string
            description: Sent with searchResultPage events. For autocomplete, identifies the
              location(header, or Special:Search main input) of the autocomplete that was
              used. For full text indicates the location of the 'did you mean' that was used
              (either autorewrite, suggestion, original, or rewritten)
          didyoumeanvisible:
            type: string
            description: Sent with full text searchResultPage events. Indicates which did
              you mean options, if any, are presented to the user on this page.
          autocompletetype:
            type: string
            description: The type of search that was performed for autocomplete. Sent with
              searchResultPage events with a source of autocomplete.
          mstodisplayresults:
            type: integer
            description: The number of milliseconds it took between requesting results and
              showing them to the user in a searchResultPage event. This is always reported
              for autocomplete events and is only reported on browsers supporting the navigation
              timing api for full text.
          searchtoken:
            type: string
            description: Token, primarily for debugging, which associates a search to a log
              in the CirrusSearchRequestSets hive table
          extraparams:
            type: string
            description: |-
              Allows for additional parameters:
              'completion-suggest-on' if user has opted-in to the Completion Suggester beta feature,
              NULL otherwise
          uniqueid:
            type: string
            description: A unique id per-event to allow deduplicating events that are sent
              multiple times. This happens in particular with IE where we emulate sendBeacon
              and often enough send click events twice.
          isforced:
            type: boolean
            description: A way to flag events that came from a user who entered themselves
              into search satisfaction logging. For example, when we want to debug or test
              new code.
          samplemultiplier:
            type: number
            description: Account for sampling by reporting a multiplier representing the number
              of events this should count as.

examples:
  - {"event":{"action":"visitPage","source":"fulltext","searchsessionid":"637f1345d71834b06463k8j4of7t","pageviewid":"9b8c9ab1b52c21e966edk8j4xj6f","scroll":false,"mwsessionid":"ee4f8d334a450a0fe63e","uniqueid":"cb271b4b1ec0c5c83e84k8j4xj6o","samplemultiplier":1,"articleid":4,"position":0,"searchtoken":"4cqr8vzf5t0g1boh1k9cckz2c","query":"test test test"},"schema":"SearchSatisfaction","webhost":"dev.wiki.local.wmftest.net","wiki":"wiki","$schema":"/analytics/legacy/searchsatisfaction/1.0.0","meta":{"dt":"2020-04-02T19:11:20.942Z","stream":"eventlogging_SearchSatisfaction","id":"b0caf18d-6c7f-4403-947d-2712bbe28610","request_id":"bd54dd80-7515-11ea-98e5-fd72443e8b45"},"dt":"2020-04-02T19:11:20.942Z","http":{"client_ip":"10.0.2.2","request_headers":{"user-agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36"}}}
